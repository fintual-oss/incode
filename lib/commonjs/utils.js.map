{"version":3,"sources":["utils.tsx"],"names":["ifUndefined","field","defaultValue","undefined","moduleDefaultsFixers","Approve","config","module","forceApproval","UserScore","mode","SelfieScan","ret","showTutorial","DocumentScan","Conference","disableMicOnStart","VideoSelfie","selfieLivenessCheck","selfieScanMode","showIdScan","showDocumentScan","showVoiceConsent","voiceConsentQuestionsCount","modulesConfigDefaultConfigEnhancement","numToDate","d","num","Number","parseInt","Date","toIntMaybe","idScanConversion","e","rawOcr","result","ocrData","transformedEvent","data","JSON","parse","birthDate","addressStatementEmissionDate","issueDate","expirationDate","expireAt","images","resultsConversions"],"mappings":"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","sourcesContent":["import type { IdScanCompleteEvent, IncodeModuleConfig } from './index';\n\nexport const ifUndefined = (field: any, defaultValue: any) =>\n  field === undefined ? defaultValue : field;\n\nconst moduleDefaultsFixers = {\n  Approve: (config: IncodeModuleConfig): IncodeModuleConfig => {\n    if (config.module === 'Approve' && config.forceApproval === undefined) {\n      return {\n        ...config,\n        forceApproval: false,\n      };\n    }\n    return config;\n  },\n  UserScore: (config: IncodeModuleConfig): IncodeModuleConfig => {\n    if (config.module === 'UserScore' && config.mode === undefined) {\n      return {\n        ...config,\n        mode: 'accurate',\n      };\n    }\n    return config;\n  },\n  SelfieScan: (config: IncodeModuleConfig): IncodeModuleConfig => {\n    if (config.module === 'SelfieScan') {\n      var ret = config;\n      if (config.showTutorial === undefined) {\n        ret = {\n          ...ret,\n          showTutorial: true,\n        };\n      }\n\n      return ret;\n    }\n    return config;\n  },\n  DocumentScan: (config: IncodeModuleConfig): IncodeModuleConfig => {\n    if (config.module === 'DocumentScan' && config.showTutorial === undefined) {\n      return {\n        ...config,\n        showTutorial: true,\n      };\n    }\n    return config;\n  },\n  Conference: (config: IncodeModuleConfig): IncodeModuleConfig => {\n    if (\n      config.module === 'Conference' &&\n      config.disableMicOnStart === undefined\n    ) {\n      return {\n        ...config,\n        disableMicOnStart: true,\n      };\n    }\n    return config;\n  },\n\n  VideoSelfie: (config: IncodeModuleConfig): IncodeModuleConfig => {\n    if (config.module === 'VideoSelfie') {\n      return {\n        ...config,\n        showTutorial: ifUndefined(config.showTutorial, true),\n        selfieLivenessCheck: ifUndefined(config.selfieLivenessCheck, false),\n        selfieScanMode: ifUndefined(config.selfieScanMode, 'selfieMatch'),\n        showIdScan: ifUndefined(config.showIdScan, true),\n        showDocumentScan: ifUndefined(config.showDocumentScan, true),\n        showVoiceConsent: ifUndefined(config.showVoiceConsent, true),\n        voiceConsentQuestionsCount: ifUndefined(config.voiceConsentQuestionsCount, 3),\n      };\n    }\n    return config;\n  },\n};\n\nexport const modulesConfigDefaultConfigEnhancement = (\n  config: IncodeModuleConfig\n): IncodeModuleConfig => {\n  switch (config.module) {\n    case 'VideoSelfie':\n      return moduleDefaultsFixers.VideoSelfie(config);\n    case 'Conference':\n      return moduleDefaultsFixers.Conference(config);\n    case 'SelfieScan':\n      return moduleDefaultsFixers.SelfieScan(config);\n    case 'Approve':\n      return moduleDefaultsFixers.Approve(config);\n    case 'UserScore':\n      return moduleDefaultsFixers.UserScore(config);\n    case 'DocumentScan':\n      return moduleDefaultsFixers.DocumentScan(config);\n  }\n  return config;\n};\n\nconst numToDate = (d: any) => {\n  if (d === undefined) {\n    return undefined;\n  }\n  const num = typeof d === 'string' ? Number.parseInt(d, 10) : d;\n  return new Date(num);\n};\n\nconst toIntMaybe = (d: any) => {\n  if (typeof d === 'number') {\n    return d;\n  }\n  if (typeof d === 'string') {\n    return Number.parseInt(d, 10);\n  }\n  return -1;\n};\n\nconst idScanConversion = (e: IdScanCompleteEvent): IdScanCompleteEvent => {\n  // @ts-ignore\n  const rawOcr: string = e.result.ocrData;\n\n  // Android SDK not supporting it yet - skip all of it\n  if (!rawOcr) {\n    return e;\n  }\n\n  const transformedEvent: IdScanCompleteEvent = {\n    ...e,\n    result: {\n      ...e.result,\n      data: JSON.parse(rawOcr).ocrData,\n    },\n  };\n  // @ts-ignore\n  delete transformedEvent.result['ocrData'];\n\n  // means an error in transforming it\n  if (!transformedEvent.result.data) {\n    return transformedEvent;\n  }\n\n  const ret = {\n    ...transformedEvent,\n    result: {\n      ...transformedEvent.result,\n      data: {\n        ...transformedEvent.result.data,\n        birthDate: numToDate(transformedEvent.result.data.birthDate),\n        addressStatementEmissionDate: numToDate(\n          transformedEvent.result.data.addressStatementEmissionDate\n        ),\n        issueDate: toIntMaybe(transformedEvent.result.data.issueDate),\n        expirationDate: toIntMaybe(transformedEvent.result.data.expirationDate),\n        expireAt: numToDate(transformedEvent.result.data.expireAt),\n        images: e.result.data.images,\n      },\n    },\n  };\n\n  return ret;\n};\n\nexport const resultsConversions = (e: any): any => {\n  if (e.module === 'IdScan') {\n    return idScanConversion(e);\n  }\n  return e;\n};\n"]}